[{"id":"adc12ba9.523ed8","type":"function","name":"ussd_payload_to_lat_lng","func":"var some_string = msg.payload;\n//var some_string = \"033365030192725631\";\n\n//  split the string into an array of raw latitude digits, arld, where [0] is sign,\n//       [1][2] are before the decimal and [3]-[9] are after the decimal.\n//       Use split() to form the array, slice() to keep only the latitude portion.\nvar arld = some_string.split(\"\").slice(0,9);\n\n//  manually make a string out of the array, [1] through [8] and insert the decimal point\ndecimal_latitude_string = arld[1]+arld[2]+\".\"+arld[3]+arld[4]+arld[5]+arld[6]+arld[7]+arld[8]+arld[9];\n\n//  make an integer out of it\nvar decimal_latitude = parseFloat(decimal_latitude_string);\n\n//  make it positive if array's [0] index is 0 and negative if it's 1\nif (arld[0] == 1) {\n    decimal_latitude = decimal_latitude * -1;\n}\n\n\n\n\n\n\n// longitude decode\n\n\n//var some_string = \"033365030192725631\";\n\n//  split the string into an array of raw longitude digits, arld, where [0] is sign,\n//       [1][2][3] are before the decimal and [4]-[9] are after the decimal.\n//       Use split() to form the array, slice() to keep only the longitude portion.\nvar arld = some_string.split(\"\").slice(9,19);\n\n//  manually make a string out of the array, [1] through [8] and insert the decimal point\ndecimal_longitude_string = arld[1]+arld[2]+arld[3]+\".\"+arld[4]+arld[5]+arld[6]+arld[7]+arld[8]+arld[9];\n\n//  make an integer out of it\nvar decimal_longitude = parseFloat(decimal_longitude_string);\n\n//  make it positive if array's [0] index is 0 and negative if it's 1\nif (arld[0] == 1) {\n    decimal_longitude = decimal_longitude * -1;\n}\n\n\n\n// Format that the function expects\n//[{\"lat\":29,\"lng\":-82}]\n\n//return [{\"lat\":decimal_latitude,\"lng\":decimal_longitude}];\nmsg.payload = \"[{\\\"lat\\\":\" + decimal_latitude + \",\\\"lng\\\":\" + decimal_longitude + \"}]\";\nreturn(msg);","outputs":1,"noerr":0,"x":180.82891845703125,"y":206.28923797607422,"z":"5869888a.a79678","wires":[["f1653d0f.0e9ac","bd2593b1.42da7"]]}]
